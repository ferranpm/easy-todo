{% extends 'base.html' %}
{% block title %}Your ToDo list {% endblock %}
{% block body %}

<script>
	function toggle(box) {
		id = $(box).data('id');
		if ($(box).is(':checked'))
			jQuery.post('/mark/' + id);
		else 
			jQuery.post('/unmark/' + id);
	}
</script>

<h1>ToDo ({{list_id}}){% if title %}: {{title}}</h1>{% else %}
{% endif %}

<table class="table table-hover">
	<tr>
		<th>#</th>
		<th>Done</th>
		<th>Todo</th>
		<th>Erase</th>
	</tr>
	{% for item in todo %}
	<tr>
		<td>{{loop.index}}</td>
		<td><input type="checkbox" onclick="toggle(this);" data-id="{{item[2]}}" {% if item[1] %}checked=""{% endif %} /></td>
		<td><span>{{item[0]}}</span></td>
		<td><a href="#" class="btn btn-danger">Erase</a></td>
	</tr>
	{% endfor %}
</table>

<form action="/add/{{list_id}}" method="POST" class="">
	<input type="text" placeholder="Item" name="todo" class="input-xxlarge" />
	<input type="submit" class="btn btn-primary" />
</form>

{% if not title %}
<form action="/settitle/{{list_id}}" method="POST">
	<input type="text" placeholder="Set title" name="title" class="input-large" />
	<input type="submit" class="btn" />
</form>
{% endif %}

{% if password %}
<form action="/login" method="POST">
	<input type="text" placeholder="Passord" name="password" class="input" />
	<input type="submit" class="btn" />
</form>
{% else %}
<form action="/setpassword/{{list_id}}" method="POST">
	<input type="text" placeholder="Set password" name="password" class="input" />
	<input type="submit" class="btn" />
</form>
{% endif %}

{% endblock %}
